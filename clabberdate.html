<head>
  <title>clabberdate</title>
</head>

<body>
	{{> header }}

	<div id="username-form-wrapper" class="modal">
		<div class="username-form-label">
			<img src="/write.png">
			What name should everyone else see you as?
			<input type="text" id="username-form" /><br/>
			<input type="submit" id="username-submit" value="Done" />
		</div>
	</div>

	{{# if is_page "landing" }}
		{{> landing }}
	{{ else }}
		{{> calendar }}
	{{/ if }}
</body>

<template name="user_prompt">
	Username: <input type="text" id="choose-username" value="{{ username }}" />
	<input type="submit" id="save-username" value="Save" />
	{{ user_id }}
</template>

<template name="calendar">
	<div id="calendar-header">
		{{# if calendar }}
		{{# with calendar }}
			<h2 id="calendar-description">{{ description }}</h2>
			<div id="calendar-description-sub">
				Organized by <strong>{{ username creator_id }}. </strong>
				<span id="calendar-age">Created {{ human_time timestamp }}.</span>
			</div>
		{{/ with }}
		{{/ if }}
	</div>

	<div id="calendar-contributors">
		<strong>People contributing</strong>
		{{# each users }}
		<div class="calendar-contributor">
			{{ username this }}
		</div>
		{{/ each }}
	</div>
	<div class="clear"></div>

	<div id="calendar-dates">
	{{# each dates }}
		{{> date }}
	{{/ each }}
	</div>

	<br/>
	<input type="text" id="calendar-comment-input" />
	<input type="submit" id="calendar-comment-submit" value="Comment" />

	<br/>

	<div id="calendar-comments">
	{{# each comments }}
	<div class="calendar-comment">
		{{# if user_id }}
		<div class="comment-user">
			{{ username user_id }}
		</div>
		<div class="comment-text arrow_box">
			<span class="comment-time">
				{{ comment_time time }}
			</span>
			<span class="comment-body">
				{{ text }}
			</span>
		</div>
		<div class="comment-date">
			{{ comment_date time }}
		</div>
		{{/ if }}
	</div>
	{{/ each }}
	</div>
</template>

<template name="date">
	<div class="date">
		{{ format_date date }}
		{{# each responses _id }}
			{{ username user_id }}
		{{/ each }}
	</div>
	<input class="set-positive" type="button" value="Good Date ({{ positive_count _id }})"/>
	<input class="set-negative" type="button" value="Bad Date ({{ negative_count _id }})"/>
</template>

<template name="recent_calendars">
Calendars you've made:<br/>
</template>

